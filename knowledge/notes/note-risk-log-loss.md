---
id: note-risk-log-loss
title: ログ欠損リスクと対策
created: 2025-12-15
source: [[2025-12-15_incident_review]]
---

## Summary（3行）
- 12/14に推薦ログ120万件が欠損するインシデント発生
- 原因はディスク容量不足（ログローテーション設定ミス）
- 再発防止策としてアラート設定と設定変更プロセスを導入

## Tags
#risk #incident #log #infrastructure #monitoring

## Links
- [[note-risk-timeline-delay]]
- [[note-data-recommendation-log]]
- [[note-open-infra-cloud]]

## Body

**インシデント概要**:
12/14 02:00にバッチ処理が異常終了し、約10時間分のログが欠損。推薦ログ120万件のうち、100万件（83%）は復旧できたが、20万件は復旧不可。

**根本原因分析（5 Whys）**:
1. バッチが止まった ← 2. ディスク100% ← 3. ログ削除されず ← 4. ローテーション設定変更 ← 5. 設定管理プロセス不備

**教訓**:
- 「一時的な設定変更」は戻し忘れリスクが高い
- 監視アラートがないとインシデント発見が遅れる
- ログの冗長化（CDN）が復旧に有効だった

**再発防止策**:
| 対策 | 担当 | 期限 | ステータス |
|------|------|------|-----------|
| ディスク80%アラート | 木村 | 12/17 | 完了 |
| ログローテーション修正 | 木村 | 12/16 | 完了 |
| 設定変更PRレビュー必須化 | チーム | 12/20 | 完了 |

## Action
- [x] アラート設定完了を確認（田中、12/18完了）
